{% extends "base.html" %}

{% block content %}
<div class="container py-4" style="max-width: 480px;">
  <h1 class="h4 mb-3">Enter OTP</h1>

  {% if flashes %}
    {% for f in flashes %}
      <div class="alert alert-{{ 'danger' if f.type == 'error' else f.type }} alert-dismissible fade show" role="alert">
        {{ f.text }}
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
      </div>
    {% endfor %}
  {% endif %}

  <form action="/verify" method="post" novalidate>
    <!-- CSRF -->
    <input type="hidden" name="csrf_token" value="{{ csrf_token }}">

    <div class="mb-3">
      <label for="code" class="form-label">6-digit code</label>
      <input
        id="code"
        name="code"
        type="text"
        inputmode="numeric"
        autocomplete="one-time-code"
        class="form-control"
        minlength="6"
        maxlength="6"
        required
        placeholder="______"
      >
      <div class="form-text">Check your email for the code. It expires in {{ otp_exp_minutes }} minutes.</div>
    </div>

    <button class="btn btn-primary w-100" type="submit">Verify</button>
  </form>

  <form action="/verify/resend" method="post" class="mt-3">
    <input type="hidden" name="csrf_token" value="{{ csrf_token }}">
    <button class="btn btn-link p-0" type="submit">Resend code</button>
  </form>
</div>
{% endblock %}
