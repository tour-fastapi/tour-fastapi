{% extends "base.html" %}
{% block title %}All Operators by City{% endblock %}

{% block content %}
{% import "shared/_macros.html" as ui %}
{# version: operators_list + logos #}


<main class="page">
  <header class="page-header">
    <div class="page-title-wrap">
      <div class="page-title-group">
        <h1 class="page-title">Umrah Tour Operators by City</h1>
        <p class="page-subtitle">Browse verified Umrah tour operators across cities</p>
      </div>

    <span class="page-count ">
        {{ total_operators }} operator{{ 's' if total_operators != 1 else '' }}
        ‚Ä¢
        {{ total_cities }} cit{{ 'ies' if total_cities != 1 else 'y' }}
      </span>
    </div>
  </header>

  

  {% if cities and cities|length > 0 %}
    {% for group in cities %}
      <div class="group">
        <header class="group-header">
          <h2 class="group-title">{{ group.city }}</h2>
           <span class="group-count">
                        {{ group.agencies|length }} operator{{ 's' if agencies|length != 1 else '' }}

          </span>
        </header>
        
         <div class="operator-list">

            {% if group.agencies and group.agencies|length > 0 %}
            
            
              {% for a in group.agencies %}
                <a class="operator-card" href="/umrah_operators/{{ a.registration_id }}">

                  <div class="operator-avatar" data-tone="{{ (loop.index0 + (a.agencies_name|length)) % 12 }}">
                  {{ ui.agency_badge(a, 56, True) }}
                </div>
                  <div class="operator-card__body">
                    <h3 class="operator-card__title">{{ a.agencies_name }}</h3>
                    <div class="operator-card__meta">{{ a.city or '-' }}, {{ a.country or '-' }}</div>

                    {% if a.description %}
                      <p class="operator-card__desc">{{ a.description }}</p>
                    {% endif %}

                    <div class="operator-meta-primary">
                      <span class="meta-item">
                        <span class="meta-icon">üì¶</span>
                        <span>3 upcoming packages</span>
                      </span>

                      <span class="meta-sep">‚Ä¢</span>

                      <span class="meta-item">
                        <span>Starting from ‚Çπ45,000</span>
                      </span>

                      <span class="meta-sep">‚Ä¢</span>

                      <span class="meta-item">
                        <span class="meta-icon">‚≠ê</span>
                        <span>4.6</span>
                      </span>
                    </div>
                    <div class="operator-meta-primary operator-meta-muted is-hidden">
                      <span>No upcoming packages</span>
                    </div>
                    <div class="operator-meta-secondary">
                      <span>In business since 2019</span>
                      <span class="meta-sep">‚Ä¢</span>
                      <span>120+ tours</span>
                      <span class="meta-sep">‚Ä¢</span>
                      <span>3,500+ pilgrims</span>
                    </div>

                    {% if a.min_package_price %}
                      <div class="operator-card__sub">
                        Packages from <strong>‚Çπ {{ a.min_package_price }}</strong>
                      </div>
                    {% endif %}
                  </div>


                  
                </a>
              {% endfor %}
           </div>
          {% else %}
            <div class="empty">No operators in {{ group.city }}.</div>
          {% endif %}
          </div>
        
    {% endfor %}
  {% else %}
    <div class="card"><div class="empty">No operators available yet.</div></div>
  {% endif %}
</main>
{% endblock %}
