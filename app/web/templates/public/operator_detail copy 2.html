{% extends "base.html" %}

{% block content %}
<main class="operator-details">
    
    <!-- Hero Section -->
    <section class="operator-details__hero">
      <div class="operator-details__hero-container">
        
        <!-- Badges -->
        <div class="operator-details__badges">
          <span class="operator-details__badge operator-details__badge--verified">
            <svg fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd" d="M6.267 3.455a3.066 3.066 0 001.745-.723 3.066 3.066 0 013.976 0 3.066 3.066 0 001.745.723 3.066 3.066 0 012.812 2.812c.051.643.304 1.254.723 1.745a3.066 3.066 0 010 3.976 3.066 3.066 0 00-.723 1.745 3.066 3.066 0 01-2.812 2.812 3.066 3.066 0 00-1.745.723 3.066 3.066 0 01-3.976 0 3.066 3.066 0 00-1.745-.723 3.066 3.066 0 01-2.812-2.812 3.066 3.066 0 00-.723-1.745 3.066 3.066 0 010-3.976 3.066 3.066 0 00.723-1.745 3.066 3.066 0 012.812-2.812zm7.44 5.252a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" />
            </svg>
            Verified Operator
          </span>
          <span class="operator-details__badge operator-details__badge--premium">Premium Packages</span>
        </div>

        <!-- Title -->
        <h1 class="operator-details__title">Al Warsi Tours & Travels</h1>

        <!-- Meta Info -->
        <div class="operator-details__meta">
          <div class="operator-details__location">
            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
            </svg>
            Mumbai, India
          </div>
          <div class="operator-details__divider">•</div>
          <div class="operator-details__rating">
            <svg fill="currentColor" viewBox="0 0 20 20">
              <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z" />
            </svg>
            4.8
          </div>
          <div class="operator-details__reviews">(250 reviews)</div>
        </div>

        <!-- Stats -->
        <div class="operator-details__stats">
          <div class="operator-details__stat">
            <span class="operator-details__stat-value">150+</span>
            <span class="operator-details__stat-label">Tours Completed</span>
          </div>
          <div class="operator-details__divider">|</div>
          <div class="operator-details__stat">
            <span class="operator-details__stat-value">8,500+</span>
            <span class="operator-details__stat-label">Pilgrims Served</span>
          </div>
          <div class="operator-details__divider">|</div>
          <div class="operator-details__stat">
            <span class="operator-details__stat-label">Since</span>
            <span class="operator-details__stat-value">2015</span>
          </div>
        </div>

      </div>
    </section>

    <!-- Contact Section -->
    <section class="operator-details__contact">
      <div class="operator-details__contact-container">
        <div class="operator-details__contact-info">
          <div class="operator-details__contact-item">
            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z" />
            </svg>
            +91 98765 43210
          </div>
          <div class="operator-details__contact-item">
            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
            </svg>
            info@alwarsitours.com
          </div>
          <div class="operator-details__contact-item">
            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9a9 9 0 01-9-9m9 9c1.657 0 3-4.03 3-9s-1.343-9-3-9m0 18c-1.657 0-3-4.03-3-9s1.343-9 3-9m-9 9a9 9 0 019-9" />
            </svg>
            www.alwarsitours.com
          </div>
        </div>
        <div class="operator-details__contact-cta">
          <button class="btn btn--primary">Contact Operator</button>
        </div>
      </div>
    </section>

    <!-- Available Packages Section -->
    <section class="operator-details__packages">
      <div class="operator-details__packages-container">
        
        <!-- Section Header -->
        <div class="operator-details__packages-header">
          <h2 class="operator-details__packages-title">Available Packages</h2>
          <span class="operator-details__packages-count">12 packages</span>
        </div>

        <!-- Package List -->
        <div class="operator-details__packages-list">
          
          <!-- Package Item 1 -->
          <div class="package-list-item">
            <div class="package-list-item__date">
              <div class="package-list-item__date-month">MON</div>
              <div class="package-list-item__date-day">12</div>
              <div class="package-list-item__date-month-name">Jan</div>
            </div>
            <div class="package-list-item__info">
              <h3 class="package-list-item__title">JANUARY 15 DAYS PACKAGE UMRAH</h3>
              <div class="package-list-item__meta">
                <span class="package-list-item__meta-item">economy</span>
                <span class="package-list-item__divider">•</span>
                <span class="package-list-item__meta-item">15D</span>
                <span class="package-list-item__divider">•</span>
                <span class="package-list-item__meta-item">Air India</span>
              </div>
            </div>
            <div class="package-list-item__price">
              <div class="package-list-item__price-value">₹94000</div>
              <div class="package-list-item__price-label">Starting</div>
            </div>
          </div>

          <!-- Package Item 2 -->
          <div class="package-list-item">
            <div class="package-list-item__date">
              <div class="package-list-item__date-month">MON</div>
              <div class="package-list-item__date-day">12</div>
              <div class="package-list-item__date-month-name">Jan</div>
            </div>
            <div class="package-list-item__info">
              <h3 class="package-list-item__title">Al Abaya Special</h3>
              <div class="package-list-item__meta">
                <span class="package-list-item__meta-item">economy</span>
                <span class="package-list-item__divider">•</span>
                <span class="package-list-item__meta-item">10D</span>
                <span class="package-list-item__divider">•</span>
                <span class="package-list-item__meta-item">Air India</span>
              </div>
              <p class="package-list-item__note">testing first package on mac</p>
            </div>
            <div class="package-list-item__price">
              <div class="package-list-item__price-value">₹91000</div>
              <div class="package-list-item__price-label">Starting</div>
            </div>
          </div>

          <!-- Add more package items as needed -->

        </div>

      </div>
    </section>

  </main>
<div class="py-3">

  
  
<!-- Header -->
<div class="card mb-3">
  <div class="card-body d-flex flex-column align-items-center gap-2">

    {% if agency.logo_path %}
      <img
        src="/media/agency/{{ agency.registration_id }}/logo?v={{ agency.logo_uploaded_at or 0 }}"
        alt="{{ agency.agencies_name }} logo"
        style="max-height:100px; max-width:280px; object-fit:contain; border:1px solid #eee; background:#fff; padding:8px; border-radius:8px;">
    {% endif %}

    <h1 class="h4 mb-1 text-center w-100">{{ agency.agencies_name }}</h1>
    <div class="text-muted mb-2 text-center w-100">
      {{ display_city }}{% if agency.country %}, {{ agency.country }}{% endif %}
    </div>

    {% if agency.description %}
      <p class="mb-0 text-center">{{ agency.description }}</p>
    {% else %}
      <p class="mb-0 text-muted text-center">No description provided.</p>
    {% endif %}
  </div>
</div>


  {# ---------- At a glance (agency stats + registration) ---------- #}
  {% set has_any_stat = (
      agency.public_registration_code or
      agency.operating_since is not none or
      agency.num_umrah_tours is not none or
      agency.num_hajj_tours is not none or
      agency.num_pilgrims_sent is not none
  ) %}
  {% if has_any_stat %}
  <div class="card mb-3">
    <div class="card-header"><strong>At a glance</strong></div>
    <div class="card-body">
      <div class="row gy-3">
        {% if agency.public_registration_code %}
          <div class="col-12 col-sm-6 col-lg-4">
            <div class="small text-muted">Registration Code</div>
            <div class="fw-semibold">{{ agency.public_registration_code }}</div>
          </div>
        {% endif %}

        <div class="col-12 col-sm-6 col-lg-4">
          <div class="small text-muted">Operating Since</div>
          <div class="fw-semibold">
            {{ agency.operating_since if agency.operating_since is not none else "—" }}
          </div>
        </div>

        <div class="col-12 col-sm-6 col-lg-4">
          <div class="small text-muted">Umrah Tours Conducted</div>
          <div class="fw-semibold">
            {{ agency.num_umrah_tours if agency.num_umrah_tours is not none else "—" }}
          </div>
        </div>

        <div class="col-12 col-sm-6 col-lg-4">
          <div class="small text-muted">Hajj Tours Conducted</div>
          <div class="fw-semibold">
            {{ agency.num_hajj_tours if agency.num_hajj_tours is not none else "—" }}
          </div>
        </div>

        <div class="col-12 col-sm-6 col-lg-4">
          <div class="small text-muted">Pilgrims Served</div>
          <div class="fw-semibold">
            {{ agency.num_pilgrims_sent if agency.num_pilgrims_sent is not none else "—" }}
          </div>
        </div>
      </div>
    </div>
  </div>
  {% endif %}

  {# ---------- Contacts & Online presence ---------- #}
  {% set has_email = agency.agency_email %}
  {% set has_links = agency.website_url or agency.instagram_url or agency.facebook_url %}
  {% if has_email or has_links %}
  <div class="row g-3 mb-3">
    {% if has_email %}
    <div class="col-md-6">
      <div class="card h-100">
        <div class="card-header"><strong>Contact</strong></div>
        <div class="card-body">
          <div class="mb-2">
            <div class="small text-muted">Email</div>
            <a href="mailto:{{ agency.agency_email }}">{{ agency.agency_email }}</a>
          </div>
        </div>
      </div>
    </div>
    {% endif %}

    {% if has_links %}
    <div class="col-md-6">
      <div class="card h-100">
        <div class="card-header"><strong>Online</strong></div>
        <div class="card-body">
          <div class="d-flex flex-wrap gap-3">
            {% if agency.website_url %}
              <a href="{{ agency.website_url }}" target="_blank" rel="noopener" class="link-primary">Website</a>
            {% endif %}
            {% if agency.instagram_url %}
              <a href="{{ agency.instagram_url }}" target="_blank" rel="noopener" class="link-primary">Instagram</a>
            {% endif %}
            {% if agency.facebook_url %}
              <a href="{{ agency.facebook_url }}" target="_blank" rel="noopener" class="link-primary">Facebook</a>
            {% endif %}
          </div>
        </div>
      </div>
    </div>
    {% endif %}
  </div>
  {% endif %}

  {# ---------- Main Branch (address / contact person / number / location) ---------- #}
  {% if branch %}
  <div class="card mb-3">
    <div class="card-header"><strong>Main Branch</strong></div>
    <div class="card-body">
      <div class="row gy-3">
        <div class="col-12 col-md-4">
          <div class="small text-muted">Branch Name</div>
          <div class="fw-semibold">{{ branch.name or "—" }}</div>
        </div>

        <div class="col-12 col-md-4">
          <div class="small text-muted">Contact</div>
          <div class="fw-semibold">
            {% if branch.contact_person or branch.contact_number %}
              {{ branch.contact_person or "—" }}
              {% if branch.contact_number %} • {{ branch.contact_number }}{% endif %}
            {% else %}
              —
            {% endif %}
          </div>
        </div>

        <div class="col-12 col-md-4">
          <div class="small text-muted">Location</div>
          <div class="fw-semibold">
            {% set loc_city = branch.city or agency.city %}
            {% set loc_country = branch.country or agency.country %}
            {% if loc_city or loc_country %}
              {{ loc_city }}{% if loc_country %}, {{ loc_country }}{% endif %}
            {% else %}
              —
            {% endif %}
          </div>
        </div>

        <div class="col-12">
          <div class="small text-muted">Address</div>
          <div class="fw-semibold">
            {% if branch.address_line1 or branch.address_line2 %}
              {% if branch.address_line1 %}{{ branch.address_line1 }}{% endif %}
              {% if branch.address_line2 %}<br>{{ branch.address_line2 }}{% endif %}
            {% else %}
              —
            {% endif %}
          </div>
        </div>
      </div>
    </div>
  </div>
  {% endif %}

  <!-- Packages -->
  <h2 class="h5 mb-2">Packages</h2>
  {% if packages and packages|length > 0 %}
    <div class="list-group">
      {% for p in packages %}
        <a class="list-group-item list-group-item-action" href="/umrah_packages/{{ p.package_id }}">
          <div class="d-flex w-100 justify-content-between">
            <strong>{{ p.package_name }}</strong>
            <small class="text-muted">
              {% if p.days %}{{ p.days }} day{{ 's' if p.days != 1 else '' }}{% endif %}
              {% if p.days and p.price is not none %} • {% endif %}
              {% if p.price is not none %}₹{{ '%.2f'|format(p.price) }}{% endif %}
            </small>
          </div>
          {% if p.description %}
            <div class="small text-muted mt-1">{{ p.description }}</div>
          {% endif %}
        </a>
      {% endfor %}
    </div>
  {% else %}
    <div class="alert alert-light border">This operator has no packages yet.</div>
  {% endif %}
</div>
{% endblock %}
