{% extends "base.html" %}
{% block title %}Packages in {{ city }}{% endblock %}
{% block content %}


<main class="page">
  
  <header class="page-header">
    <a class="page-back" href="/umrah_packages">
      ← Back to packages
    </a>

    <div class="page-title-wrap">
      <div class="page-title-group">
        <h1 class="page-title">
          Umrah Packages in {{ city }}
        </h1>

        <p class="page-subtitle">
          Available Umrah packages departing from {{ city }}
        </p>
      </div>

      <span class="page-count">
        {{ count }} package{{ 's' if count != 1 else '' }}
      </span>
    </div>
  </header>


  <div class="card">
    {% if packages and packages|length > 0 %}
      <div class="grid">
        {% for p in packages %}
          {% set ag = agency_by_id.get(p.registration_id) %}
          {% set href = "/umrah_packages/" ~ p.package_id %}
          <a class="pkg" href="{{ href }}">
            <div class="pkg-media"></div>
            <div class="pkg-body">
              <h3 class="pkg-name">{{ p.package_name }}</h3>
              <div class="pkg-sub">
                {% if p.days %}<span class="chip">{{ p.days }} day{{ 's' if p.days != 1 else '' }}</span>{% endif %}
                {% if p.price is not none %}<span class="chip">₹ {{ '%0.2f'|format(p.price) }}</span>{% endif %}
                {% if ag and ag.agencies_name %}<span class="chip">{{ ag.agencies_name }}</span>{% endif %}
                {% if ag and ag.country %}<span class="chip">{{ ag.country }}</span>{% endif %}
              </div>
              {% if p.description %}
              <div class="pkg-desc">{{ p.description }}</div>
              {% endif %}
              <div class="pkg-foot">
                <div>{{ ag.city if ag and ag.city else '—' }}, {{ ag.country if ag and ag.country else '—' }}</div>
                <div class="cta">View details →</div>
              </div>
            </div>
          </a>
        {% endfor %}
      </div>
    {% else %}
      <div class="empty">No packages found in {{ city }}.</div>
    {% endif %}
  </div>
</main>
{% endblock %}
