{# app/web/templates/package/themes/basic.html #}

<style>
  /* ========== BASIC (Light, crisp, professional) ========== */
  .theme-basic {
    --fg: #0f172a;
    --muted: #64748b;
    --card: #ffffff;
    --bg-grad: linear-gradient(180deg, #f7fafc, #ffffff);
    --border: #e5e7eb;
    --hair: #eef2f6;
    --chip: #f3f4f6;
    --accent: #1d4ed8;
    --radius: 14px;
    --shadow: 0 10px 24px rgba(2,6,23,.08);
  }
  .theme-basic { color: var(--fg); }
  .theme-basic .band {
    border-radius: var(--radius);
    padding: 18px;
    background: var(--bg-grad);
    border: 1px solid var(--border);
    box-shadow: var(--shadow);
  }
  .theme-basic .card-soft {
    background: var(--card);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    box-shadow: 0 8px 20px rgba(2,6,23,.06);
  }
  .theme-basic .chip {
    padding:.24rem .6rem; border-radius:999px; background:var(--chip); border:1px solid var(--border); font-size:.75rem;
  }
  .theme-basic .kicker { font-size:.78rem; letter-spacing:.06em; text-transform:uppercase; color:var(--muted); }
  .theme-basic .label-m { font-size:.74rem; letter-spacing:.04em; text-transform:uppercase; color:var(--muted); }
  .theme-basic .price-lg { font-size:clamp(24px,3.2vw,34px); line-height:1; font-weight:800; letter-spacing:-.01em; }
  .theme-basic a { color: var(--accent); text-decoration: none; }
  .theme-basic a:hover { text-decoration: underline; }
  .theme-basic .muted { color: var(--muted); }
  .theme-basic .sep { height:1px; background: var(--hair); margin:.5rem 0 1rem; border-radius:1px; }
  .theme-basic .block { border:1px dashed var(--border); border-radius:12px; padding:.85rem 1rem; background:#fbfcfe; }
  .theme-basic .img-brd { border:1px solid var(--border); border-radius: 12px; }

  .theme-basic .hero-img {
    width: 100%;
    max-height: 340px;
    object-fit: cover;
    border-radius: 12px;
    border: 1px solid var(--border);
    display: block;
  }

  .theme-basic .hero-top {
    display: flex;
    align-items: flex-start;
    gap: 12px;
  }
  .theme-basic .hero-meta {
    flex: 1;
    min-width: 0;
  }
  .theme-basic .hero-price {
    text-align: right;
    min-width: 180px;
  }

  @media (max-width: 768px) {
    .theme-basic .hero-top { flex-direction: column; }
    .theme-basic .hero-price { text-align: left; min-width: auto; }
  }

  .btn-primary {
    background: linear-gradient(90deg, #2563eb, #1d4ed8);
    color: #fff;
    border: none;
    transition: all .25s ease;
  }
  .btn-primary:hover {
    background: linear-gradient(90deg, #1e3a8a, #1d4ed8);
    transform: translateY(-2px);
  }
</style>

{% set month_names = {
  1:'January',2:'February',3:'March',4:'April',5:'May',6:'June',
  7:'July',8:'August',9:'September',10:'October',11:'November',12:'December'
} %}

{# ---- Banner (with fallback + cache-buster to avoid "same banner" bug) ---- #}
{% set banner_name = pkg.banner_image or 'dynamic-tawaf-at-night.jpg' %}
{% set banner_url = '/media/packages-banners/' ~ banner_name ~ '?v=' ~ (pkg.package_id|string) ~ '-' ~ banner_name %}

<div class="theme-basic">

  <!-- Header -->
  <div class="band mb-3">

    <!-- Banner first (full width) -->
    <img
      src="{{ banner_url }}"
      alt="{{ pkg.package_name }}"
      class="hero-img"
      loading="lazy"
    >

    <div class="mt-3 hero-top">
      <!-- Agency logo -->
      <img
        src="/media/agency/{{ agency.registration_id }}/logo"
        alt="{{ agency.agencies_name }} logo"
        width="56" height="56"
        class="rounded img-brd"
        onerror="this.style.display='none'"
      />

      <div class="hero-meta">
        <h1 class="h4 mb-1">{{ pkg.package_name }}</h1>

        <div class="d-flex flex-wrap align-items-center gap-2 small muted">
          <span>{{ pkg.days }} days</span>

          {% if pkg.travel_month or pkg.travel_year %}
            <span>
              •
              {{ month_names.get((pkg.travel_month or 0)|int, '') }}
              {{ pkg.travel_year or '' }}
            </span>
          {% endif %}

          {% if pkg.package_class %}
            <span>• {{ pkg.package_class | title }}</span>
          {% endif %}

          {% if pkg.package_type %}
            <span class="chip">{{ pkg.package_type | title }}</span>
          {% endif %}
        </div>

        {% if pkg.description %}
          <div class="small mt-2">{{ pkg.description }}</div>
        {% endif %}

        {% if agency and agency.agencies_name %}
          <div class="small muted mt-2">
            {{ agency.agencies_name }}{% if agency.city %}, {{ agency.city }}{% endif %}
          </div>
        {% endif %}
      </div>

      <!-- Price -->
      <div class="hero-price">
        <div class="kicker mb-1">Starting</div>
        <div class="price-lg">₹{{ "%.2f"|format(pkg.price or 0) }}</div>

        {% if price_row and (price_row.price_double or price_row.price_triple or price_row.price_quad) %}
          <div class="small muted mt-2">
            {% if price_row.price_double %}Double/Couple • ₹{{ "%.2f"|format(price_row.price_double) }}<br>{% endif %}
            {% if price_row.price_triple %}Triple • ₹{{ "%.2f"|format(price_row.price_triple) }}<br>{% endif %}
            {% if price_row.price_quad %}Quad/Quint • ₹{{ "%.2f"|format(price_row.price_quad) }}{% endif %}
          </div>
        {% endif %}

        {% if price_row and price_row.price_note %}
          <div class="small muted mt-1">{{ price_row.price_note }}</div>
        {% endif %}
      </div>
    </div>
  </div>

  <!-- Flights -->
  <div class="card-soft p-3 p-md-4 mb-3">
    <h2 class="h6 mb-3">Flights</h2>
    <div class="sep"></div>

    <div class="row g-3">
      <div class="col-md-6">
        <div class="block h-100">
          <div class="label-m mb-1">Onward</div>
          <div>{{ onward_text or '—' }}</div>
        </div>
      </div>

      <div class="col-md-6">
        <div class="block h-100">
          <div class="label-m mb-1">Return</div>
          <div>{{ return_text or '—' }}</div>
        </div>
      </div>
    </div>
  </div>

  <!-- Stays -->
  <div class="card-soft p-3 p-md-4 mb-3">
    <h2 class="h6 mb-3">Stays</h2>
    <div class="sep"></div>

    <div class="row g-3">
      <!-- Mecca -->
      <div class="col-md-6">
        <div class="block h-100">
          <div class="fw-semibold mb-2">Mecca</div>

          <div class="label-m">Dates</div>
          <div class="mb-2">{{ mecca_dates or '—' }}</div>

          <div class="label-m">Distance</div>
          <div class="mb-2">{{ mecca_distance_label or '—' }}</div>

          <div class="label-m">Hotel</div>
          <div>
            {% if mecca_hotel_name %}
              {% if mecca_hotel_link %}
                <a href="{{ mecca_hotel_link }}" target="_blank" rel="noopener">{{ mecca_hotel_name }}</a>
              {% else %}
                {{ mecca_hotel_name }}
              {% endif %}
            {% else %}
              —
            {% endif %}
          </div>

          {% if mecca_similar_hotels %}
            <div class="label-m mt-2">Or similar</div>
            <div class="small">
              {% for h in mecca_similar_hotels %}
                {% if h.link %}
                  <a href="{{ h.link }}" target="_blank" rel="noopener">{{ h.name }}</a>
                {% else %}
                  {{ h.name }}
                {% endif %}
                {% if not loop.last %}, {% endif %}
              {% endfor %}
            </div>
          {% endif %}
        </div>
      </div>

      <!-- Medinah -->
      <div class="col-md-6">
        <div class="block h-100">
          <div class="fw-semibold mb-2">Medinah</div>

          <div class="label-m">Dates</div>
          <div class="mb-2">{{ med_dates or '—' }}</div>

          <div class="label-m">Distance</div>
          <div class="mb-2">{{ med_distance_label or '—' }}</div>

          <div class="label-m">Hotel</div>
          <div>
            {% if med_hotel_name %}
              {% if med_hotel_link %}
                <a href="{{ med_hotel_link }}" target="_blank" rel="noopener">{{ med_hotel_name }}</a>
              {% else %}
                {{ med_hotel_name }}
              {% endif %}
            {% else %}
              —
            {% endif %}
          </div>

          {% if med_similar_hotels %}
            <div class="label-m mt-2">Or similar</div>
            <div class="small">
              {% for h in med_similar_hotels %}
                {% if h.link %}
                  <a href="{{ h.link }}" target="_blank" rel="noopener">{{ h.name }}</a>
                {% else %}
                  {{ h.name }}
                {% endif %}
                {% if not loop.last %}, {% endif %}
              {% endfor %}
            </div>
          {% endif %}
        </div>
      </div>
    </div>
  </div>

  <!-- Inclusions -->
  <div class="card-soft p-3 p-md-4">
    <h2 class="h6 mb-3">Inclusions</h2>
    <div class="sep" style="margin-top:-.25rem;"></div>

    {% set incl = pkg.inclusion %}

<ul class="mb-0">
  {% if incl %}
    {% set has_any = (
      incl.meals_enabled or incl.meals_desc or
      incl.laundry_enabled or incl.laundry_desc or
      incl.transport_enabled or incl.transport_desc or
      incl.zamzam_enabled or incl.zamzam_desc or
      incl.welcome_kit_enabled or incl.welcome_kit_desc or
      incl.insurance_enabled or incl.insurance_desc or
      incl.visa_enabled or incl.visa_desc or
      incl.ziyarat_enabled or incl.ziyarat_desc or
      incl.other
    ) %}

    {% if incl.meals_enabled or incl.meals_desc %}<li>Meals: {{ incl.meals_desc or "Included" }}</li>{% endif %}
    {% if incl.laundry_enabled or incl.laundry_desc %}<li>Laundry: {{ incl.laundry_desc or "Included" }}</li>{% endif %}
    {% if incl.transport_enabled or incl.transport_desc %}<li>Transport: {{ incl.transport_desc or "Included" }}</li>{% endif %}
    {% if incl.zamzam_enabled or incl.zamzam_desc %}<li>Zam Zam: {{ incl.zamzam_desc or "Included" }}</li>{% endif %}
    {% if incl.welcome_kit_enabled or incl.welcome_kit_desc %}<li>Welcome Kit: {{ incl.welcome_kit_desc or "Included" }}</li>{% endif %}
    {% if incl.insurance_enabled or incl.insurance_desc %}<li>Insurance: {{ incl.insurance_desc or "Included" }}</li>{% endif %}

    {# ✅ NEW #}
    {% if incl.visa_enabled or incl.visa_desc %}<li>VISA: {{ incl.visa_desc or "Included" }}</li>{% endif %}
    {% if incl.ziyarat_enabled or incl.ziyarat_desc %}<li>Ziyarat: {{ incl.ziyarat_desc or "Included" }}</li>{% endif %}

    {% if incl.other %}<li>{{ incl.other }}</li>{% endif %}

    {% if not has_any %}
      <li>No inclusions listed.</li>
    {% endif %}
  {% else %}
    <li>No inclusions listed.</li>
  {% endif %}
</ul>

  </div>

</div>
