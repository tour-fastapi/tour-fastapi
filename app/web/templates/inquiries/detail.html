{% extends "base.html" %}
{% block title %}Inquiry • {{ q.name }}{% endblock %}
{% block content %}
<style>
  .wrap{max-width:900px;margin:28px auto;padding:0 16px;}
  .head{display:flex;justify-content:space-between;align-items:center;margin-bottom:14px}
  h1{margin:0;font-size:1.6rem;font-weight:800}
  .card{background:#fff;border:1px solid #e5e7eb;border-radius:14px;padding:18px}
  .row{display:grid;grid-template-columns:160px 1fr;gap:10px;margin:8px 0}
  .label{color:#6b7280}
  .actions{display:flex;gap:10px;margin-top:14px;flex-wrap:wrap}
  .btn{display:inline-block;padding:10px 12px;border:1px solid #e5e7eb;border-radius:10px;text-decoration:none}
  .btn.primary{background:#2563eb;border-color:#2563eb;color:#fff}
</style>

<div class="wrap">
  <div class="head">
    <h1>Inquiry • {{ q.name }}</h1>
    <div>
      <a class="btn" href="/inquiries">← All Inquiries</a>
      <a class="btn" href="/agency/{{ agency.registration_id }}/dashboard">Dashboard</a>
    </div>
  </div>

  {% if flashes %}
    {% for f in flashes %}
      <div style="margin-bottom:8px;color:#155e75">{{ f.message }}</div>
    {% endfor %}
  {% endif %}

  <div class="card">
    <div class="row"><div class="label">ID</div><div>#{{ q.inquiry_id }}</div></div>
    <div class="row"><div class="label">Name</div><div>{{ q.name }}</div></div>
    <div class="row"><div class="label">Phone</div><div>{{ q.phone_number }}</div></div>
    <div class="row"><div class="label">Source</div><div>{{ q.source or '–' }}</div></div>
    <div class="row"><div class="label">Created</div><div>{{ q.created_at }}</div></div>
    <div class="row"><div class="label">Message</div><div>{{ q.inquiry }}</div></div>

    <div class="actions">
      <a class="btn primary" href="tel:{{ q.phone_number }}">Call</a>
      <a class="btn"
         target="_blank"
         href="https://wa.me/{{ q.phone_number|replace(' ','')|replace('+','') }}?text={{ ('Hello '+q.name+', regarding your inquiry for '+agency.agencies_name)|urlencode }}">
         WhatsApp
      </a>
      <a class="btn" id="copy">Copy Name & Phone</a>
    </div>
  </div>
</div>

<script>
  document.getElementById('copy')?.addEventListener('click', ()=>{
    const txt = "{{ (q.name ~ ' - ' ~ q.phone_number)|e }}";
    navigator.clipboard.writeText(txt).then(()=>{
      const btn = document.getElementById('copy'); btn.textContent = 'Copied'; setTimeout(()=>btn.textContent='Copy Name & Phone', 1200);
    });
  });
</script>
{% endblock %}
